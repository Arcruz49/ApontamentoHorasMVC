@using System.Security.Claims
@{
    var user = Context.User;
    var nome = user.FindFirst(ClaimTypes.Name)?.Value;
    var admin = user.FindFirst("Admin")?.Value == "True";
    ViewData["Title"] = "Registro de Ponto";
}

<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - ApontamentoHoras</title>


    <link rel="stylesheet" href="~/css/notyf.min.css" />
    <script src="~/lib/tailwind.js"></script>
    <script src="~/lib/lucide.min.js"></script>
    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/notyf.min.js"></script>
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/ApontamentoHoras.styles.css" asp-append-version="true" />


    <style>

    </style>
</head>

<body class="flex min-h-screen overflow-hidden">
    <!-- Sidebar -->
    <aside id="sidebar" class="glass w-64 flex flex-col justify-between py-6 px-5 fixed inset-y-0 left-0 z-40">
        <div>
            <div class="flex items-center justify-between mb-8">
                <div class="flex items-center gap-3">
                    <img src="~/images/default_profile.jpg" class="w-12 h-12 object-cover rounded-full border-2 border-violet-500" alt="foto perfil">                    
                    <div>
                        <p class="font-semibold text-white">@nome</p>
                        <p class="text-sm text-gray-400">Desenvolvedor</p>
                    </div>
                </div>
            </div>

            <a href="/Apontamento" class="w-full bg-gradient-to-r from-violet-600 to-indigo-500 text-white py-3 rounded-2xl font-medium mb-8 shadow-lg hover:scale-105 transition inline-flex items-center justify-center">
                <i data-lucide="clock" class="inline w-4 h-4 mr-2"></i> Marcar Ponto
            </a>


            <nav class="flex flex-col gap-2 text-gray-400">
                <a href="/" class="flex items-center gap-3 p-2 rounded-xl hover:bg-violet-700/20 hover:text-white transition">
                    <i data-lucide="home"></i> Início
                </a>
                <a href="#" class="flex items-center gap-3 p-2 rounded-xl hover:bg-violet-700/20 hover:text-white transition">
                    <i data-lucide="bell"></i> Lembretes
                </a>
                <a href="#" class="flex items-center gap-3 p-2 rounded-xl hover:bg-violet-700/20 hover:text-white transition">
                    <i data-lucide="message-square"></i> Comunicados
                </a>
                <a href="#" class="flex items-center gap-3 p-2 rounded-xl hover:bg-violet-700/20 hover:text-white transition">
                    <i data-lucide="calendar"></i> Reuniões
                </a>
                <a href="#" class="flex items-center gap-3 p-2 rounded-xl hover:bg-violet-700/20 hover:text-white transition">
                    <i data-lucide="file-text"></i> Histórico
                </a>
                
                @if(admin)
                {
                   <a href="/Usuario" class="flex items-center gap-3 p-2 rounded-xl hover:bg-violet-700/20 hover:text-white transition">
                      <i data-lucide="users"></i> Usuários
                  </a>

                }
                 



            </nav>
        </div>

        <div class="flex flex-col gap-3 mt-6">
            @* <button class="flex items-center gap-2 text-gray-400 hover:text-white transition hover:scale-105">
                <i data-lucide="moon"></i> Modo claro
            </button> *@
            <a href="/Usuario/Logout" class="flex items-center gap-2 text-gray-400 hover:text-white transition hover:scale-105">
                <i data-lucide="log-out"></i> Sair
            </a>
        </div>
    </aside>

    <!-- Main Content -->
    <div class="container ml-64">
        <main role="main" class="pb-3">
            @RenderBody()
        </main>
    </div>



    <div id="loadingModal" class="hidden fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50">
        <div class="flex flex-col items-center">
            <img src="~/images/loading.gif" alt="Carregando..." class="w-64 h-64 mb-4 animate-pulse">
        </div>
    </div>

    <script>
        $(document).ready(function () {

            lucide.createIcons();

            const botoes = [$("#btnCasa"), $("#btnEscritorio"), $("#btnOutro")];
            botoes.forEach(btn => {
                btn.on("click", function () {
                    botoes.forEach(b => b.removeClass("border-violet-500 bg-violet-700/20").addClass("border-gray-700 bg-gray-800"));
                    $(this).addClass("border-violet-500 bg-violet-700/20");
                });
            });

            let progresso = 0;
            const circle = $("#progress-circle");
            const horas = $("#horasTrabalhadas");

            setInterval(() => {
                progresso = (progresso + 2) % 100;
                circle.attr("stroke-dasharray", `${progresso},100`);
                const h = Math.floor(progresso / 6);
                const m = (progresso * 36) % 60;
                horas.text(`${String(h).padStart(2, "0")}:${String(m).padStart(2, "0")}`);
            }, 1000);

        
        }); 

        function showLoading() {
            $("#loadingModal").removeClass("hidden");
        }

        function hideLoading() {
            $("#loadingModal").addClass("hidden");
        }

    </script>

    @RenderSection("Scripts", required: false)
</body>
</html>
